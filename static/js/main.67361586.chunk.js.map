{"version":3,"sources":["components/TopicListContainer.tsx","utils.ts","consts.ts","App.tsx","index.tsx"],"names":["TopicListContainer","props","this","dateStr","date","topics","className","length","map","t","idx","href","url","title","id","React","Component","formatDate","timestamp","tempData","Date","year","getFullYear","month","getMonth","getDate","getCurrentTimeStamp","now","getTimezoneOffset","getTime","App","state","isFetching","dailyTopics","failedFetching","beginingTimestamp","currentTimestamp","utils","formatDateString","rawDataFilePath","fetch","res","json","setState","concat","console","error","d","onClick","refreshPage","bind","setTimeout","componentDidMount","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"2SASqBA,G,8DAGnB,WAAYC,GAAe,IAAD,8BACxB,cAAMA,IAHDA,WAEmB,EAGxB,EAAKA,MAAQA,EAHW,E,qDAMT,IAAD,EACoBC,KAAKD,MAAzBE,EADA,EACNC,KAAeC,EADT,EACSA,OAEvB,OACE,sBAAKC,UAAU,mBAAf,UACE,mBAAGA,UAAU,YAAb,SAA0BH,IACP,IAAlBE,EAAOE,OACN,mBAAGD,UAAU,YAAb,sCAEAD,EAAOG,KAAI,SAACC,EAAGC,GAAJ,OAET,cADA,CACA,OAAKJ,UAAU,kBAAf,UACE,uBAAMA,UAAU,aAAhB,UAA8BI,EAAM,EAApC,OACA,mBAAGJ,UAAU,YAAYK,KAAMF,EAAEG,IAAjC,SACGH,EAAEI,UAH+BJ,EAAEK,c,GApBJC,IAAMC,YCL/C,SAASC,EAAWC,GACzB,IAAMC,EAAW,IAAIC,KAAKF,GAEpBG,EAAOF,EAASG,cAClBC,EAAyBJ,EAASK,WAAa,EAC/CpB,EAAwBe,EAASM,UASrC,OAPIF,EAAQ,KACVA,EAAQ,IAAMA,GAEZnB,EAAO,KACTA,EAAO,IAAMA,GAGT,GAAN,OAAUiB,EAAV,YAAkBE,EAAlB,YAA2BnB,GAItB,SAASsB,IAGd,OAFoB,IAAIN,KAAKA,KAAKO,MAOM,IAAjC,IAAIP,MAAOQ,oBAA2B,KAL1BC,UCvBd,ICyGQC,E,kDApFb,WAAY7B,GAAa,IAAD,8BACtB,cAAMA,IAHD8B,WAEiB,EAGtB,EAAKA,MAAQ,CACXC,YAAY,EACZC,YAAa,GACbC,gBAAgB,GANI,E,0LAWhBC,ED7BoC,WC8BtCC,EAAmBC,I,YAEhBD,EAAmBD,G,wBAClBG,EAAmBD,EAAiBD,GACpCG,EDrCqB,kFCqCiBD,EAAmB,Q,kBAG3CE,MAAMD,G,cAAlBE,E,YAEEH,E,UACQG,EAAIC,O,oBAFdT,E,CACJ7B,K,KACAC,O,MAGFH,KAAKyC,SAAS,CACZV,YAAa/B,KAAK6B,MAAME,YAAYW,OAAOX,K,yDAG7C/B,KAAKyC,SAAS,CACZT,gBAAgB,IAElBW,QAAQC,MAAR,M,6BAIFV,GDnDwC,M,uBCsD1ClC,KAAKyC,SAAS,CACZX,YAAY,I,+IAKd,OACE,sBAAK1B,UAAU,iBAAf,UACE,wBAAQA,UAAU,cAAlB,uDAECJ,KAAK6B,MAAME,YAAYzB,KAAI,SAACuC,GAAD,OAC1B,cAAC,EAAD,CAEE1C,OAAQ0C,EAAE1C,OACVD,KAAM2C,EAAE3C,MAFH2C,EAAE3C,SAMVF,KAAK6B,MAAMC,YAAc,kEAEzB9B,KAAK6B,MAAMG,gBACV,2EAEE,sBAAM5B,UAAU,aAAa0C,QAAS9C,KAAK+C,YAAYC,KAAKhD,MAA5D,gE,oCASa,IAAD,OACpBA,KAAKyC,SAAS,CACZX,YAAY,EACZC,YAAa,GACbC,gBAAgB,IAGlBiB,YAAW,WACT,EAAKC,sBACJ,S,GAnFWrC,IAAMC,WCfxBqC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.67361586.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"../css/topic-list-container.css\";\r\nimport { Topic } from \"../types\";\r\n\r\ntype Props = {\r\n  date: string;\r\n  topics: Topic[];\r\n};\r\n\r\nexport default class TopicListContainer extends React.Component {\r\n  public props: Props;\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n\r\n    this.props = props;\r\n  }\r\n\r\n  public render() {\r\n    const { date: dateStr, topics } = this.props;\r\n\r\n    return (\r\n      <div className=\"topics-container\">\r\n        <p className=\"date-text\">{dateStr}</p>\r\n        {topics.length === 0 ? (\r\n          <p className=\"null-text\">空空如也</p>\r\n        ) : (\r\n          topics.map((t, idx) => (\r\n            // NOTE: define topic item element\r\n            <div className=\"topic-container\" key={t.id}>\r\n              <span className=\"index-text\">{idx + 1}.</span>\r\n              <a className=\"link-text\" href={t.url}>\r\n                {t.title}\r\n              </a>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","/**\r\n * 根据时间戳返回特殊格式化后的字符串，例如 2020-12-21\r\n * @param timestamp 时间戳，单位毫秒\r\n */\r\nexport function formatDate(timestamp: number): string {\r\n  const tempData = new Date(timestamp);\r\n\r\n  const year = tempData.getFullYear();\r\n  let month: number | string = tempData.getMonth() + 1;\r\n  let date: number | string = tempData.getDate();\r\n\r\n  if (month < 10) {\r\n    month = \"0\" + month;\r\n  }\r\n  if (date < 10) {\r\n    date = \"0\" + date;\r\n  }\r\n\r\n  return `${year}-${month}-${date}`;\r\n}\r\n\r\n/** 返回此时时间戳，以毫秒为单位 */\r\nexport function getCurrentTimeStamp(): number {\r\n  const currentDate = new Date(Date.now() + getTimezoneMsOffset());\r\n\r\n  return currentDate.getTime();\r\n}\r\n\r\n/** 返回时区差值，以毫秒为单位 */\r\nexport function getTimezoneMsOffset(): number {\r\n  return new Date().getTimezoneOffset() * 60 * 1000;\r\n}\r\n","\r\n/** 数据文件url前缀 */\r\nexport const RAW_JSON_BASE_URL = \"https://raw.githubusercontent.com/realLeonardo/v2ex-daily-hot-topic/master/raw/\"\r\n\r\n/** 数据爬虫开始日期: \"2020/12/18\" */\r\nexport const SCRIPT_BEGIN_TIMESTAMP: number = 1608220800000\r\n\r\n/** 一天的毫秒数 */\r\nexport const DAY_MILLISECONDS_COUNT: number = 24 * 60 * 60 * 1000;\r\n","import React from \"react\";\nimport \"./css/app.css\";\nimport TopicListContainer from \"./components/TopicListContainer\";\nimport * as utils from \"./utils\";\nimport { Topic } from \"./types\";\nimport {\n  RAW_JSON_BASE_URL,\n  SCRIPT_BEGIN_TIMESTAMP,\n  DAY_MILLISECONDS_COUNT,\n} from \"./consts\";\n\ntype State = {\n  isFetching: boolean;\n  dailyTopics: {\n    date: string;\n    topics: Topic[];\n  }[];\n  failedFetching: boolean;\n};\n\nclass App extends React.Component {\n  public state: State;\n\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      isFetching: true,\n      dailyTopics: [],\n      failedFetching: false,\n    };\n  }\n\n  async componentDidMount() {\n    const beginingTimestamp = SCRIPT_BEGIN_TIMESTAMP;\n    let currentTimestamp = utils.getCurrentTimeStamp();\n\n    while (currentTimestamp > beginingTimestamp) {\n      const formatDateString = utils.formatDate(currentTimestamp);\n      const rawDataFilePath = RAW_JSON_BASE_URL + formatDateString + \".json\";\n\n      try {\n        const res = await fetch(rawDataFilePath);\n        const dailyTopics = {\n          date: formatDateString,\n          topics: await res.json(),\n        };\n\n        this.setState({\n          dailyTopics: this.state.dailyTopics.concat(dailyTopics),\n        });\n      } catch (error) {\n        this.setState({\n          failedFetching: true,\n        });\n        console.error(error);\n        break;\n      }\n\n      currentTimestamp -= DAY_MILLISECONDS_COUNT;\n    }\n\n    this.setState({\n      isFetching: false,\n    });\n  }\n\n  public render() {\n    return (\n      <div className=\"page-container\">\n        <header className=\"header-text\">V2EX 每日热门话题</header>\n        {/* 每日话题列表 */}\n        {this.state.dailyTopics.map((d) => (\n          <TopicListContainer\n            key={d.date}\n            topics={d.topics}\n            date={d.date}\n          ></TopicListContainer>\n        ))}\n        {/* fetching status text */}\n        {this.state.isFetching && <p>获取数据中...</p>}\n        {/* fetch failed result text */}\n        {this.state.failedFetching && (\n          <p>\n            获取数据失败，\n            <span className=\"error-text\" onClick={this.refreshPage.bind(this)}>\n              尝试刷新一下吧\n            </span>\n          </p>\n        )}\n      </div>\n    );\n  }\n\n  private refreshPage() {\n    this.setState({\n      isFetching: true,\n      dailyTopics: [],\n      failedFetching: false,\n    });\n\n    setTimeout(() => {\n      this.componentDidMount();\n    }, 2000);\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./css/index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}